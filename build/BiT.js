'use strict';class b{constructor(){this.D;this.c;this.h;this.a;this.b;this.s;this.u;this.m;this.o;this.w;this.A;this.C;this.F;this.B;this.lineHeight;this.i;this.v}};class g{constructor(){this.f=11;this.g=5;this.j=-1;this.G=this.l=0;this.H=.66;this.b=0;this.i=this.h=this.c=this.a=!1}};class k{constructor(){this.data=[[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7],[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,7],[4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7],[4,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7],[4,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,7],[4,0,4,0,0,0,0,5,5,5,5,5,5,5,5,5,7,7,0,7,7,7,7,7],[4,0,5,0,0,0,0,5,0,5,0,5,0,5,0,5,7,0,0,0,7,7,7,1],[4,0,6,0,0,0,0,5,0,0,0,0,0,0,0,5,7,0,0,0,0,0,0,8],[4,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,7,7,1],[4,0,8,0,0,0,0,5,0,
0,0,0,0,0,0,5,7,0,0,0,0,0,0,8],[4,0,0,0,0,0,0,5,0,0,0,0,0,0,0,5,7,0,0,0,7,7,7,1],[4,0,0,0,0,0,0,5,5,5,5,0,5,5,5,5,7,7,7,7,7,7,7,1],[6,6,6,6,6,6,6,6,6,6,6,0,6,6,6,6,6,6,6,6,6,6,6,6],[8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4],[6,6,6,6,6,6,0,6,6,6,6,0,6,6,6,6,6,6,6,6,6,6,6,6],[4,4,4,4,4,4,0,4,4,4,6,0,6,2,2,2,2,2,2,2,3,3,3,3],[4,0,0,0,0,0,0,0,0,4,6,0,6,2,0,0,0,0,0,2,0,0,0,2],[4,0,0,0,0,0,0,0,0,0,0,0,6,2,0,0,5,0,0,2,0,0,0,2],[4,0,0,0,0,0,0,0,0,4,6,0,6,2,0,0,0,0,0,2,2,0,2,2],[4,0,6,0,6,0,0,0,0,4,
6,0,0,0,0,0,5,0,0,0,0,0,0,2],[4,0,0,5,0,0,0,0,0,4,6,0,6,2,0,0,0,0,0,2,2,0,2,2],[4,0,6,0,6,0,0,0,0,4,6,0,6,2,0,0,5,0,0,2,0,0,0,2],[4,0,0,0,0,0,0,0,0,4,6,0,6,2,0,0,0,0,0,2,0,0,0,2],[4,4,4,4,4,4,4,4,4,4,1,1,1,2,2,2,2,2,2,3,3,3,3,3]]}get a(){return this.data}};class l{constructor(){this.s=this.s.bind(this);this.K=new b;this.a=new g;this.h=(new k).a;this.I=[];this.C=new Image;this.b=document.createElement("canvas");this.b.width=window.innerWidth;this.b.height=window.innerHeight;this.b.style.a="pixelated";this.b.addEventListener("touchend",()=>{this.m=!1;this.o=this.D=this.w=this.v=0;this.a.b=0;this.a.a=!1;this.a.c=!1});this.b.addEventListener("touchmove",d=>{this.m&&(this.D=-.1*(this.v-d.touches[0].clientX),this.o=this.w-d.touches[0].clientY,0!=this.o&&
(this.a.a=!0))},{passive:!1});this.b.addEventListener("touchstart",d=>{this.m=!0;this.v=d.touches[0].clientX;this.w=d.touches[0].clientY},{passive:!1});document.body.appendChild(this.b);this.b.addEventListener("click",()=>{this.b.requestPointerLock()});this.i=this.b.getContext("2d",{alpha:!1});this.i.imageSmoothingEnabled=!1;this.i.lineWidth=1;this.u=this.F=0;this.m=!1;this.c=this.o=this.D=this.w=this.v=0;this.A=1;document.addEventListener("pointerlockchange",()=>{document.pointerLockElement==this.b?
document.addEventListener("mousemove",this.s,!1):document.removeEventListener("mousemove",this.s,!1)},!1);document.addEventListener("keyup",d=>{switch(d.keyCode){case 87:this.a.a=!1;break;case 83:this.a.c=!1;break;case 65:this.a.h=!1;break;case 68:this.a.i=!1;break;case 16:this.A=1}},!1);document.addEventListener("keydown",d=>{switch(d.keyCode){case 87:this.a.a=!0;break;case 83:this.a.c=!0;break;case 65:this.a.h=!0;break;case 68:this.a.i=!0;break;case 16:this.A=2.5}},!1);document.getElementById("fullscreen").addEventListener("click",
()=>{this.b.requestFullscreen&&this.b.requestFullscreen()});window.addEventListener("resize",()=>{this.b.width=window.innerWidth;this.b.height=window.innerHeight;this.i.imageSmoothingEnabled=!1})}s(d){this.a.b=d.movementX}};const m=new l;
function n(d){var a=(d-m.F)/1E3;m.c=3*a*m.A;if(1==m.m||m.a.b!=m.u){if(m.m){var e=m.D;m.c=m.o/1E3}else e=(m.u+m.a.b)/2;m.u=m.a.b;a=e*a*-.1;e=m.a.j;m.a.j=m.a.j*Math.cos(a)-m.a.l*Math.sin(a);m.a.l=e*Math.sin(a)+m.a.l*Math.cos(a);e=m.a.G;m.a.G=m.a.G*Math.cos(a)-m.a.H*Math.sin(a);m.a.H=e*Math.sin(a)+m.a.H*Math.cos(a)}m.a.a&&(0==m.h[Math.floor(m.a.f+m.a.j*m.c*15)][Math.floor(m.a.g)]&&(m.a.f+=m.a.j*m.c),0==m.h[Math.floor(m.a.f)][Math.floor(m.a.g+m.a.l*m.c*15)]&&(m.a.g+=m.a.l*m.c));m.a.i&&(a=(m.a.j*Math.cos(Math.PI/
2)-m.a.l*Math.sin(Math.PI/2))*m.c,0==m.h[Math.floor(m.a.f-15*a)][Math.floor(m.a.g)]&&(m.a.f-=a),a=(m.a.j*Math.sin(Math.PI/2)+m.a.l*Math.cos(Math.PI/2))*m.c,0==m.h[Math.floor(m.a.f)][Math.floor(m.a.g-15*a)]&&(m.a.g-=a));m.a.h&&(a=(m.a.j*Math.cos(-Math.PI/2)-m.a.l*Math.sin(-Math.PI/2))*m.c,0==m.h[Math.floor(m.a.f-15*a)][Math.floor(m.a.g)]&&(m.a.f-=a),a=(m.a.j*Math.sin(-Math.PI/2)+m.a.l*Math.cos(-Math.PI/2))*m.c,0==m.h[Math.floor(m.a.f)][Math.floor(m.a.g-15*a)]&&(m.a.g-=a));m.a.c&&(0==m.h[Math.floor(m.a.f-
m.a.j*m.c*15)][Math.floor(m.a.g)]&&(m.a.f-=m.a.j*m.c),0==m.h[Math.floor(m.a.f)][Math.floor(m.a.g-m.a.l*m.c*15)]&&(m.a.g-=m.a.l*m.c));m.F=d;m.i.fillStyle="#777777";m.i.fillRect(0,0,m.b.width,m.b.height/2);m.i.fillStyle="#bbbbbb";m.i.fillRect(0,m.b.height/2,m.b.width,m.b.height);for(d=0;d<m.b.width;d+=1){a=m.K;var f=d,h=m.h;var c=m.a;e=m.b;a.F=0;a.D=2*f/e.width-1;a.c=c.j+c.G*a.D;a.h=c.l+c.H*a.D;a.a=Math.floor(c.f);a.b=Math.floor(c.g);a.s=Math.abs(1/a.c);a.u=Math.abs(1/a.h);0>a.c?(a.A=-1,a.m=(c.f-a.a)*
a.s):(a.A=1,a.m=(a.a+1-c.f)*a.s);0>a.h?(a.C=-1,a.o=(c.g-a.b)*a.u):(a.C=1,a.o=(a.b+1-c.g)*a.u);for(;0==a.F;)a.m<a.o?(a.m+=a.s,a.a+=a.A,a.B=0):(a.o+=a.u,a.b+=a.C,a.B=1),0<h[a.a][a.b]&&(a.F=1);a.w=0==a.B?(a.a-c.f+(1-a.A)/2)/a.c:(a.b-c.g+(1-a.C)/2)/a.h;a.lineHeight=Math.floor(e.height/a.w);a.i=Math.floor(-a.lineHeight/2+e.height/2);0>a.i&&(a.i=0);a.v=Math.floor(a.lineHeight/2+e.height/2);a.v>=e.height&&(a.v=e.height-1);f=h[a.a][a.b]-1;c=0==a.B?c.g+a.w*a.h:c.f+a.w*a.c;c-=Math.floor(c);c=Math.floor(64*
c);0==a.B&&0<a.c&&(c=64-c-1);1==a.B&&0>a.h&&(c=64-c-1);a={L:f,M:c,J:64*(256*a.i-128*e.height+128*a.lineHeight)/a.lineHeight/256,start:a.i,end:a.v,B:a.B};m.i.drawImage(m.I[a.L],a.M,a.J,1,64-2*a.J,d,a.end,1,a.start-a.end)}window.requestAnimationFrame(n)}(async function(){return new Promise(d=>{m.C.addEventListener("load",async()=>{for(let a=0;9>a;a++)m.I[a]=await createImageBitmap(m.C,a%3*64,64*Math.floor(a/3),64,64);d()});m.C.src="./textures.webp"})})().then(()=>{window.requestAnimationFrame(n)});
