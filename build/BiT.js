'use strict';class a{constructor(){this.F;this.c;this.h;this.a;this.b;this.s;this.u;this.m;this.o;this.A;this.B;this.C;this.D;this.i;this.lineHeight;this.w;this.v;this.color}};class g{constructor(){this.f=11;this.g=5;this.j=-1;this.G=this.l=0;this.H=.66;this.b=0;this.i=this.h=this.c=this.a=!1}};class k{constructor(){this.data=[[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7],[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,7],[4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7],[4,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7],[4,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,7],[4,0,4,0,0,0,0,5,5,5,5,5,5,5,5,5,7,7,0,7,7,7,7,7],[4,0,5,0,0,0,0,5,0,5,0,5,0,5,0,5,7,0,0,0,7,7,7,1],[4,0,6,0,0,0,0,5,0,0,0,0,0,0,0,5,7,0,0,0,0,0,0,8],[4,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,7,7,1],[4,0,8,0,0,0,0,5,0,
0,0,0,0,0,0,5,7,0,0,0,0,0,0,8],[4,0,0,0,0,0,0,5,0,0,0,0,0,0,0,5,7,0,0,0,7,7,7,1],[4,0,0,0,0,0,0,5,5,5,5,0,5,5,5,5,7,7,7,7,7,7,7,1],[6,6,6,6,6,6,6,6,6,6,6,0,6,6,6,6,6,6,6,6,6,6,6,6],[8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4],[6,6,6,6,6,6,0,6,6,6,6,0,6,6,6,6,6,6,6,6,6,6,6,6],[4,4,4,4,4,4,0,4,4,4,6,0,6,2,2,2,2,2,2,2,3,3,3,3],[4,0,0,0,0,0,0,0,0,4,6,0,6,2,0,0,0,0,0,2,0,0,0,2],[4,0,0,0,0,0,0,0,0,0,0,0,6,2,0,0,5,0,0,2,0,0,0,2],[4,0,0,0,0,0,0,0,0,4,6,0,6,2,0,0,0,0,0,2,2,0,2,2],[4,0,6,0,6,0,0,0,0,4,
6,0,0,0,0,0,5,0,0,0,0,0,0,2],[4,0,0,5,0,0,0,0,0,4,6,0,6,2,0,0,0,0,0,2,2,0,2,2],[4,0,6,0,6,0,0,0,0,4,6,0,6,2,0,0,5,0,0,2,0,0,0,2],[4,0,0,0,0,0,0,0,0,4,6,0,6,2,0,0,0,0,0,2,0,0,0,2],[4,4,4,4,4,4,4,4,4,4,1,1,1,2,2,2,2,2,2,3,3,3,3,3]]}get a(){return this.data}};class l{constructor(){this.s=this.s.bind(this);this.I=new a;this.a=new g;this.h=(new k).a;this.D=[];this.B=new Image;this.b=document.createElement("canvas");this.b.width=window.innerWidth;this.b.height=window.innerHeight;this.b.style.a="pixelated";this.b.addEventListener("touchend",()=>{this.m=!1;this.o=this.C=this.w=this.v=0;this.a.b=0;this.a.a=!1;this.a.c=!1});this.b.addEventListener("touchmove",d=>{this.m&&(this.C=-.1*(this.v-d.touches[0].clientX),this.o=this.w-d.touches[0].clientY,0!=this.o&&
(this.a.a=!0))},{passive:!1});this.b.addEventListener("touchstart",d=>{this.m=!0;this.v=d.touches[0].clientX;this.w=d.touches[0].clientY},{passive:!1});document.body.appendChild(this.b);this.b.addEventListener("click",()=>{this.b.requestPointerLock()});this.i=this.b.getContext("2d",{alpha:!1});this.i.imageSmoothingEnabled=!1;this.i.lineWidth=1;this.u=this.F=0;this.m=!1;this.c=this.o=this.C=this.w=this.v=0;this.A=1;document.addEventListener("pointerlockchange",()=>{document.pointerLockElement==this.b?
document.addEventListener("mousemove",this.s,!1):document.removeEventListener("mousemove",this.s,!1)},!1);document.addEventListener("keyup",d=>{switch(d.keyCode){case 87:this.a.a=!1;break;case 83:this.a.c=!1;break;case 65:this.a.h=!1;break;case 68:this.a.i=!1;break;case 16:this.A=1}},!1);document.addEventListener("keydown",d=>{switch(d.keyCode){case 87:this.a.a=!0;break;case 83:this.a.c=!0;break;case 65:this.a.h=!0;break;case 68:this.a.i=!0;break;case 16:this.A=2.5}},!1);document.getElementById("fullscreen").addEventListener("click",
()=>{this.b.requestFullscreen&&this.b.requestFullscreen()});window.addEventListener("resize",()=>{this.b.width=window.innerWidth;this.b.height=window.innerHeight;this.i.imageSmoothingEnabled=!1})}s(d){this.a.b=d.movementX}};const m=new l;
function n(d){var b=(d-m.F)/1E3;m.c=3*b*m.A;if(1==m.m||m.a.b!=m.u){if(m.m){var c=m.C;m.c=m.o/1E3}else c=(m.u+m.a.b)/2;m.u=m.a.b;b=c*b*-.1;c=m.a.j;m.a.j=m.a.j*Math.cos(b)-m.a.l*Math.sin(b);m.a.l=c*Math.sin(b)+m.a.l*Math.cos(b);c=m.a.G;m.a.G=m.a.G*Math.cos(b)-m.a.H*Math.sin(b);m.a.H=c*Math.sin(b)+m.a.H*Math.cos(b)}m.a.a&&(0==m.h[Math.floor(m.a.f+m.a.j*m.c*15)][Math.floor(m.a.g)]&&(m.a.f+=m.a.j*m.c),0==m.h[Math.floor(m.a.f)][Math.floor(m.a.g+m.a.l*m.c*15)]&&(m.a.g+=m.a.l*m.c));m.a.i&&(b=(m.a.j*Math.cos(Math.PI/
2)-m.a.l*Math.sin(Math.PI/2))*m.c,0==m.h[Math.floor(m.a.f-15*b)][Math.floor(m.a.g)]&&(m.a.f-=b),b=(m.a.j*Math.sin(Math.PI/2)+m.a.l*Math.cos(Math.PI/2))*m.c,0==m.h[Math.floor(m.a.f)][Math.floor(m.a.g-15*b)]&&(m.a.g-=b));m.a.h&&(b=(m.a.j*Math.cos(-Math.PI/2)-m.a.l*Math.sin(-Math.PI/2))*m.c,0==m.h[Math.floor(m.a.f-15*b)][Math.floor(m.a.g)]&&(m.a.f-=b),b=(m.a.j*Math.sin(-Math.PI/2)+m.a.l*Math.cos(-Math.PI/2))*m.c,0==m.h[Math.floor(m.a.f)][Math.floor(m.a.g-15*b)]&&(m.a.g-=b));m.a.c&&(0==m.h[Math.floor(m.a.f-
m.a.j*m.c*15)][Math.floor(m.a.g)]&&(m.a.f-=m.a.j*m.c),0==m.h[Math.floor(m.a.f)][Math.floor(m.a.g-m.a.l*m.c*15)]&&(m.a.g-=m.a.l*m.c));m.F=d;m.i.fillStyle="#777777";m.i.fillRect(0,0,m.b.width,m.b.height/2);m.i.fillStyle="#bbbbbb";m.i.fillRect(0,m.b.height/2,m.b.width,m.b.height);for(d=0;d<m.b.width;d+=1){b=m.I;var f=d,h=m.h;c=m.a;var e=m.b;b.D=0;b.F=2*f/e.width-1;b.c=c.j+c.G*b.F;b.h=c.l+c.H*b.F;b.a=Math.floor(c.f);b.b=Math.floor(c.g);b.s=Math.abs(1/b.c);b.u=Math.abs(1/b.h);0>b.c?(b.B=-1,b.m=(c.f-b.a)*
b.s):(b.B=1,b.m=(b.a+1-c.f)*b.s);0>b.h?(b.C=-1,b.o=(c.g-b.b)*b.u):(b.C=1,b.o=(b.b+1-c.g)*b.u);for(;0==b.D;)b.m<b.o?(b.m+=b.s,b.a+=b.B,b.i=0):(b.o+=b.u,b.b+=b.C,b.i=1),0<h[b.a][b.b]&&(b.D=1);b.A=0==b.i?(b.a-c.f+(1-b.B)/2)/b.c:(b.b-c.g+(1-b.C)/2)/b.h;b.lineHeight=Math.floor(e.height/b.A);b.w=Math.floor(-b.lineHeight/2+e.height/2);0>b.w&&(b.w=0);b.v=Math.floor(b.lineHeight/2+e.height/2);b.v>=e.height&&(b.v=e.height-1);f=h[b.a][b.b]-1;c=0==b.i?c.g+b.A*b.h:c.f+b.A*b.c;c-=Math.floor(c);c=Math.floor(64*
c);0==b.i&&0<b.c&&(c=64-c-1);1==b.i&&0>b.h&&(c=64-c-1);b={J:f,K:c,start:b.w,end:b.v,color:b.color};m.i.drawImage(m.D[b.J],b.K,0,1,64,d,b.end,1,b.start-b.end)}window.requestAnimationFrame(n)}(async function(){return new Promise(d=>{m.B.addEventListener("load",async()=>{for(let b=0;9>b;b++)m.D[b]=await createImageBitmap(m.B,b%3*64,64*Math.floor(b/3),64,64);d()});m.B.src="./textures.webp"})})().then(()=>{window.requestAnimationFrame(n)});
